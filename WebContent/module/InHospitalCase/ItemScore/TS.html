<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script type="text/javascript" src="../../../PUBLIC/Scripts/common.js"></script>
<script type="text/javascript" src="../../../PUBLIC/Scripts/jsloader.js"></script>
<script type="text/javascript" src="../../../PUBLIC/Scripts/jsloader_jquery.js"></script>
<script type="text/javascript" src="../../../PUBLIC/Scripts/jsloader_ext.js"></script>
<script type="text/javascript" src="../../../PUBLIC/Scripts/MyJavascripts/tableform/FormUtil.js"></script>
<script type="text/javascript" src="../../../PUBLIC/Scripts/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="../../../PUBLIC/Scripts/MyJavascripts/reportHeader.js"></script>

<link type="text/css" rel="stylesheet" href="../../../PUBLIC/Scripts/MyJavascripts/tableform/table.css"/>
<title>急诊中心急重病人综合评价(外)</title>
<style type="text/css">
.myLabel {
	font-size:12px
}
.bottomTxt {
	border:none;
	border-bottom:solid #000 1px;
}
.scoreTxt{
	border:none; 
	width:30px; 
	color:#F00; 
	text-align:center;
}
.d { 
    border-right: 1px solid #000;
	border-right-color:#000;
	border-left-color:#000;
    padding: 6px 6px 6px 12px;  
	}
</style>
<script type="text/javascript">
/*以下页面参数*/
var tableCode='ItemScore_TS';
var flag = "tab3_";
var tabID= htmlRequest.QueryString('tabID');
var keyID=htmlRequest.QueryString('keyID');
    keyID=(keyID==null?-1:keyID)

var delURL = '/KLJY/ts.do?method=deleTsById&id=' + keyID;

var PatientID=htmlRequest.QueryString('PatientID');
    PatientID=(PatientID==null?-1:PatientID);	

var kid = htmlRequest.QueryString('kid');
var addInitPar = {
		id:'3_-1',
		title:'TS_新增',
		url:'TS.html?PatientID=' + PatientID + '&keyID=-1' + '&kid=' + kid
	}

var table;
/*以上页面参数*/
Ext.onReady(function(){
	FormUtil.toDateField({el:$('#opeDate'),dateFormat:'yyyy-MM-dd HH:mm'});
	$('#patientID').val(PatientID);
	
	before_init();
	
	if(keyID < 0){
		getPatientInfo();
	}
	
	//document.getElementById('page-header').innerHTML = CreateItemPage(cfg);
	/*Ext.Ajax.request({
		url:App.App_Info.BasePath + '/KLJY/ts.do',
		params:{
			method:'getTsData',
			id:keyID
		},
		success:function(_response,_options){
			var json = Ext.util.JSON.decode(_response.responseText);
			alert(typeof(json))
			alert(JSON.stringify(json));
			document.getElementById('PatientID').value=PatientID;
		}
	});*/
	$.post(
		App.App_Info.BasePath + '/KLJY/ts.do',
		{
			method:'getTsData',
			id:keyID
		},function(data){
			if(data.success){
				var _json=JSON.parse(data.data);
				if(_json){
					setPageVlaues('form',_json);
				}
			}
		},'json');
		/*$('#patientNo').val(pinfo.patientNo);
		$('#patientName').val(pinfo.patientName);
		$('#age').val(pinfo.age);
		$('#sex').val(pinfo.gender);*/
});
	
	/*打印函数*/
	function before_init(){
		var rh=new RepoertHeader();
		rh.basePath=App.App_Info.BasePath;
		rh.el=$('#header').get(0);
		rh.cid=kid;
		rh.config.title='急重病人综合评价(外)';
		rh.create();
	}
	
function apmAction(obj){
	var checked=obj.checked;
	var checkboxs=document.getElementsByName('apm');
	for(var i=0,len=checkboxs.length;i<len;i++){
		checkboxs[i].checked=false;	
	}
	if(checked){
		obj.checked=true;		
	}else{
		obj.checked=false;	
	}
}
function checkScore(obj){
	obj.parentNode.nextSibling.childNodes[0].value=obj.value;
	GCSScore();
	totalScore();
}
function GCSScore(){
	document.getElementById('EC').value='';
	var esc1=document.getElementById('ESC1').value;
	if(esc1.length==0)
		return;
	var esc2=document.getElementById('ESC2').value;
	if(esc2.length==0)
		return;
	var esc3=document.getElementById('ESC3').value;
	if(esc3.length==0)
		return;
	document.getElementById('EC').value=eval(esc1)+eval(esc2)+eval(esc3);
}
function totalScore(){
	document.getElementById('TC').value='';
	var AC=document.getElementById('AC').value;
	if(AC.length==0)
		return;
	var BC=document.getElementById('BC').value;
	if(BC.length==0)
		return;
	var CC=document.getElementById('CC').value;
	if(CC.length==0)
		return;
	var DC=document.getElementById('DC').value;
	if(DC.length==0)
		return;
	var EC=document.getElementById('EC').value;
	if(EC.length==0)
		return;
	document.getElementById('TC').value=eval(AC)+eval(BC)+eval(CC)+eval(DC)+eval(EC);
}

	function submitData(){
	 	if(validata()){
			return;	
		}
		var data = getPageValue('form');
		Ext.Ajax.request({
			url:App.App_Info.BasePath + '/KLJY/ts.do',
			params:{
				method:'tsSaveOrUpdate',
				data:JSON.stringify(data)
			},
			success:function(_response,_options){
				if(_response.responseText&&_response.responseText.length>0)
					var json = Ext.util.JSON.decode(_response.responseText);
				if(json.success==true){
					alert('保存成功！');
					if(json){
						parent.initTree();
						setPageVlaues('form',json);
						keyID = $("#tsId").val();
						delURL = '/KLJY/ts.do?method=deleTsById&id=' + keyID;
					}
				}
			}
		});
	}
</script>
</head>
<body>
	<div id="header" style="width:760px"></div>
	<form id="form">
		<input type="hidden" name="tsId" id="tsId" value="-1" />
		<input type="hidden" name="patientID" id="patientID" value="-1"/>
		<table border=1 cellSpacing=0 borderColorDark=#ffffff cellPadding=2 width="100%" height="100%">
		  <tr>
		    <td height="27"><div class="pageDiv">
		        <table border="0" cellpadding="0" cellspacing="0" width="100%">
		          <tr>
	          		  <td align="right" width="50">&nbsp;</td>
	            	 <td align="center" style="height:25px; font-size:14px;color:#909;line-height:25px">&nbsp;</td>
	           		 <td width="50"><input type="button" class="btn_mouseout" value="提交" onClick="submitData()" /></td>
	            	 <td width="50">
	            		 <input type="button" class="btn_mouseout" value="删除" onClick="del(keyID,delURL,addInitPar,flag)" />
	           		 </td>
	         	   </tr>
		        </table>
		      </div></td>
		  </tr>
		  <tr>
		    <td valign="top" align="center"><div style=" width:750px;">
		        <table width="700" border="0" cellpadding="0" cellspacing="5" align="center">
		          <!--  <tr>
		            <td align="center"><span style="font-weight:bold; font-size:20px; line-height:40px"><br/>
		              急诊中心急重病人综合评价(外)<br/>
		              </span></td>
		          </tr>
		          -->
		          <tr>
		            <td><table width="100%" border="0" cellpadding="0" cellspacing="3" style="font-size:12px">
		                <tr>
		                  <td align="left"><span class="myLabel">急诊号</span>
		                    <input name="emergencyNo" type="text" class="bottomTxt" id="EmergencyNo" style="width:120px"/></td>
		                  <td align="right"><span class="myLabel">病案号</span>
		                    <input name="patientNo" type="text" class="bottomTxt" id="patientNo" style="width:120px"/></td>
		                </tr>
		              </table></td>
		          </tr>
		          <tr>
		            <td><div style="border:solid 1px; padding:10px; width:690px">
		                <table width="100%" border="0" cellpadding="0" cellspacing="0">
		                  <tr>
		                    <td width="150"><span class="myLabel">姓名：</span>
		                      <input name="patientName" type="text" class="bottomTxt" id="patientName" style="width:80px"/></td>
		                    <td width="130"><span class="myLabel">性别：</span>
		                      <input name="sex" type="text" class="bottomTxt" id="sex" style="width:40px"/></td>
		                    <td width="130"><span class="myLabel">年龄：</span>
		                      <input name="age" type="text" class="bottomTxt" id="age" style="width:40px"/></td>
		                    <td>
		                    	<span class="myLabel">日期：</span>
		                    	<input type="text" style="width:110px;" name="opeDate" id="opeDate" />
		                    	<span class="myLabel">
		                      		<input name="apm" type="checkbox" onClick="apmAction(this)" value="0"/>Am
		                      		<input name="apm" type="checkbox" onClick="apmAction(this)" value="1"/>Pm
		                      	</span>
		                     </td>
		                  </tr>
		                </table>
		              </div>
			   <div style="margin:5px 0 5px 0;width:690px">
		        <table width="100%" border=1 cellSpacing=0 borderColorDark=#ffffff cellPadding=2 style="border:1px solid #000;font-size:12px">
		             <tr>
		             	<td align="center" style="color:#000" width="30">危<br />重<br />综<br />合<br />症</td>
		                 <td width="270" class="d">
		                    <table width="100%" border="0" cellpadding="0" cellspacing="0" style=" font-size:12px;">
		                          <tr>
		                            <td width="50%"><input name="weizhong1" type="checkbox" id="weizhong1" value="1"/>休克</td>
		                            <td><input name="weizhong2" type="checkbox" id="weizhong2" value="2"/>急性肝功能衰竭</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong3" type="checkbox" id="weizhong3" value="3"/>DIC</td>
		                            <td><input name="weizhong4" type="checkbox" id="weizhong4" value="4"/>急性脑功能衰竭</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong5" type="checkbox" id="weizhong5" value="5"/>心脏骤停</td>
		                            <td><input name="weizhong6" type="checkbox" id="weizhong6" value="6"/>急性消化功能衰竭</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong7" type="checkbox" id="weizhong7" value="7"/>急性呼吸衰竭</td>
		                            <td><input name="weizhong8" type="checkbox" id="weizhong8" value="8"/>昏迷</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong9" type="checkbox" id="weizhong9" value="9"/>急性左心衰竭</td>
		                            <td><input name="weizhong10" type="checkbox" id="weizhong10" value="10"/>大出血</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong11" type="checkbox" id="weizhong11" value="11"/>急性肾功能衰竭</td>
		                            <td><!--<input name="weizhong12" type="checkbox" id="weizhong12" value="12"/>-->&nbsp;</td>
		                          </tr>
		                        </table>
		                     </td>
		                      <td align="center" width="30">危<br />重<br />症<br />分<br />类</td>
		                    <td width="270" class="d">
		                        <table width="100%" border="0" cellpadding="0" cellspacing="0" style=" font-size:12px;">
		                          <tr>
		                            <td width="50%"><input name="weizhong12" type="checkbox" id="weizhong12" value="1"/>
		                              普外</td>
		                            <td><input name="weizhong13" type="checkbox" id="weizhong13" value="2"/>
		                              妇科</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong14" type="checkbox" id="weizhong14" value="3"/>
		                              骨科</td>
		                            <td><input name="weizhong15" type="checkbox" id="weizhong15" value="4"/>
		                              产科</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong16" type="checkbox" id="weizhong16" value="5"/>
		                              神外</td>
		                            <td><input name="weizhong17" type="checkbox" id="weizhong17" value="6"/>
		                              五官</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong18" type="checkbox" id="weizhong18" value="7"/>
		                              泌尿</td>
		                            <td><input name="weizhong19" type="checkbox" id="weizhong19" value="8"/>
		                              皮科</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong20" type="checkbox" id="weizhong20" value="9"/>
		                              胸外</td>
		                            <td><input name="weizhong21" type="checkbox" id="weizhong21" value="10"/>
		                              介入</td>
		                          </tr>
		                          <tr>
		                            <td width="50%"><input name="weizhong22" type="checkbox" id="weizhong22" value="11"/>心外</td>
		                            <td><!--<input name="weizhong2" type="checkbox" id="weizhong2" value="12"/>-->&nbsp;</td>
		                          </tr>
		                      </table>
		         		 </td>
		              </tr>
		          </table>
		     </div>
		              
		              
		              <div style="margin:5px 0 5px 0;width:690px">
		                <table width="100%" bgcolor="#000000" cellpadding="0" cellspacing="1" border="0" style="font-size:12px" height="100">
		                  <tr>
		                    <td rowspan="2" bgcolor="#FFFFFF" width="20" align="center">诊<br/>
		                      <br/>
		                      断</td>
		                    <td bgcolor="#FFFFFF" width="60" align="center">主要<br/>
		                      诊断</td>
		                    <td bgcolor="#FFFFFF" align="center">1、
		                      <input name="zhuyao1" type="text" class="bottomTxt" id="zhuyao1" style="width:570px"/>
		                      <br/>
		                      2、
		                      <input name="zhuyao2" type="text" class="bottomTxt" id="zhuyao2" style="width:570px"/></td>
		                  </tr>
		                  <tr>
		                    <td bgcolor="#FFFFFF" align="center">合并<br/>
		                      诊断</td>
		                    <td bgcolor="#FFFFFF" align="center">1、
		                      <input name="ciyao1" type="text" class="bottomTxt" id="ciyao1" style="width:570px"/>
		                      <br/>
		                      2、
		                      <input name="ciyao2" type="text" class="bottomTxt" id="ciyao2" style="width:570px"/></td>
		                  </tr>
		                </table>
		              </div>
		              <div style="margin:5px 0 5px 0;width:690px">
		                <table width="100%" bgcolor="#000000" cellpadding="0" cellspacing="1" border="0" style="font-size:12px">
		                  <tr align="center">
		                    <td bgcolor="#FFFFFF" width="20" rowspan="6">T<br/>
		                      <br/>
		                      S<br/>
		                      <br/>
		                      总<br/>
		                      <br/>
		                      积<br/>
		                      <br/>
		                      分</td>
		                    <td bgcolor="#CCCCCC" height="30"  width="247">检验项目</td>
		                    <td bgcolor="#CCCCCC">检验结果</td>
		                    <td bgcolor="#CCCCCC" width="80">积分</td>
		                  </tr>
		                  <tr align="center">
		                    <td bgcolor="#FFFFFF" height="40">A.&nbsp; 呼&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 吸</td>
		                    <td bgcolor="#FFFFFF"><select name="ac1" id="AC1" style="width:120px" onChange="checkScore(this)">
		                        <option value=""></option>
		                        <option value="0">0</option>
		                        <option value="1">&lt;10</option>
		                        <option value="4">10-24</option>
		                        <option value="3">25-35</option>
		                        <option value="2">&gt;35</option>
		                    </select></td>
		                    <td bgcolor="#FFFFFF"><input name="ac" class="scoreTxt" id="AC" value="" readonly/></td>
		                  </tr>
		                  <tr align="center">
		                    <td bgcolor="#FFFFFF" height="40">B.&nbsp; 呼&nbsp; 吸&nbsp; 幅&nbsp; 度</td>
		                    <td bgcolor="#FFFFFF"><select name="bc1" id="BC1" style="width:120px" onChange="checkScore(this)">
		                        <option value=""></option>
		                        <option value="1">正常</option>
		                        <option value="0">浅或困难</option>
		                    </select></td>
		                    <td bgcolor="#FFFFFF"><input name="bc" class="scoreTxt" id="BC" value="" readonly/></td>
		                  </tr>
		                  <tr align="center">
		                    <td bgcolor="#FFFFFF" height="40">C. 收&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 缩&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 压</td>
		                    <td bgcolor="#FFFFFF"><select name="cc1" id="CC1" style="width:120px" onChange="checkScore(this)">
		                        <option value=""></option>
		                        <option value="0">0</option>
		                        <option value="1">&lt;50</option>
		                        <option value="2">50-69</option>
		                        <option value="3">70-90</option>
		                        <option value="4">&gt;90</option>
		                    </select></td>
		                    <td bgcolor="#FFFFFF"><input name="cc" class="scoreTxt" id="CC" value="" readonly/></td>
		                  </tr>
		                  <tr align="center">
		                    <td bgcolor="#FFFFFF" height="40">D.毛细血管充盈</td>
		                    <td bgcolor="#FFFFFF"><select name="dc1" id="DC1" style="width:120px" onChange="checkScore(this)">
		                        <option value=""></option>
		                        <option value="0">无</option>
		                        <option value="2">正常</option>
		                        <option value="1">迟缓</option>
		                    </select></td>
		                    <td bgcolor="#FFFFFF"><input name="dc" class="scoreTxt" id="DC" value="" readonly/></td>
		                  </tr>
		                  <tr align="center">
		                    <td bgcolor="#FFFFFF" height="40">E. G C S&nbsp;&nbsp;&nbsp; 总&nbsp;&nbsp; 分</td>
		                    <td bgcolor="#FFFFFF"><table width="100%" border="0" cellpadding="0" cellspacing="1" style="font-size:12px" bgcolor="#666666">
		                        <tr align="center">
		                          <td height="25" bgcolor="#CCCCCC">项目</td>
		                          <td bgcolor="#CCCCCC">结果</td>
		                          <td bgcolor="#CCCCCC">积分</td>
		                        </tr>
		                        <tr align="center">
		                          <td bgcolor="#FFFFFF" height="30">睁&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 眼</td>
		                          <td bgcolor="#FFFFFF"><select name="esc21" id="ESC21" style="width:120" onChange="checkScore(this)">
		                              <option value=""></option>
		                              <option value="4">自动睁眼</option>
		                              <option value="3">呼唤睁眼</option>
		                              <option value="2">刺疼睁眼</option>
		                              <option value="1">不睁眼</option>
		                          </select></td>
		                          <td bgcolor="#FFFFFF"><input name="esc1" class="scoreTxt" id="ESC1" value="" readonly/></td>
		                        </tr>
		                        <tr align="center">
		                          <td bgcolor="#FFFFFF" height="30">语言反应</td>
		                          <td bgcolor="#FFFFFF"><select name="esc22" id="ESC22" style="width:120" onChange="checkScore(this)">
		                              <option value=""></option>
		                              <option value="5">回答切题</option>
		                              <option value="4">回答不切题</option>
		                              <option value="3">答非所问</option>
		                              <option value="2">只能发音</option>
		                              <option value="1">不能言语</option>
		                          </select></td>
		                          <td bgcolor="#FFFFFF"><input name="esc2" class="scoreTxt" id="ESC2" value="" readonly/></td>
		                        </tr>
		                        <tr align="center">
		                          <td bgcolor="#FFFFFF" height="30">运动反应</td>
		                          <td bgcolor="#FFFFFF"><select name="esc23" id="ESC23" style="width:120" onChange="checkScore(this)">
		                              <option value=""></option>
		                              <option value="6">按吩咐动作</option>
		                              <option value="5">刺痛能定位</option>
		                              <option value="4">刺痛能躲避</option>
		                              <option value="3">刺痛肢体屈曲</option>
		                              <option value="2">刺痛肢体伸展</option>
		                              <option value="1">不能活动</option>
		                          </select></td>
		                          <td bgcolor="#FFFFFF"><input name="esc3" class="scoreTxt" id="ESC3" value="" readonly/></td>
		                        </tr>
		                      </table></td>
		                    <td bgcolor="#FFFFFF"><input name="ec" class="scoreTxt" id="EC" value="" readonly/></td>
		                  </tr>
		                </table>
		              </div>
		              <div style="margin:5px 0 5px 0;width:690px">
		                <table width="100%" bgcolor="#000000" cellpadding="0" cellspacing="1" border="0" style="font-size:12px">
		                  <tr>
		                    <td bgcolor="#FFFFFF" height="30" width="268" align="center">&nbsp;&nbsp; TS总积分</td>
		                    <td bgcolor="#FFFFFF" align="center"><input name="tc" class="scoreTxt" id="TC" value="" readonly/></td>
		                    <td bgcolor="#FFFFFF" width="200" align="center">医师签字：
		                      <input name="doctorName" type="text" class="bottomTxt" id="DoctorName" style="width:100px"/></td>
		                  </tr>
		                </table>
		              </div></td>
		          </tr>
		        </table>
		      </div></td>
		  </tr>
		</table>
	</form>
</body>
</html>
