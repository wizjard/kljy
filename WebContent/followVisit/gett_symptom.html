<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="../PUBLIC/Scripts/common.js"></script>
<script type="text/javascript" src="../PUBLIC/Scripts/jsloader.js"></script>
<script type="text/javascript" src="../PUBLIC/Scripts/jsloader_ext.js"></script>

<link rel="stylesheet" type="text/css" href="../PUBLIC/Scripts/dTree/css/dtree.css"/>
<script type="text/javascript" src="../PUBLIC/Scripts/dTree/js/dtree.js"></script>
<title>症状列表</title>

<script language=javascript>
var dtree=null;
var treeNodeId=-1;
var indexId=-1;
	Ext.Ajax.request({
		url:App.App_Info.BasePath+'/followVisit/yanxingbinAction.do?method=findT_symptom',
		success:function(_response,_options){
			var responseJson=Ext.util.JSON.decode(_response.responseText);
			if(responseJson.success){
				var nodes=Ext.util.JSON.decode(responseJson.data);
				dtree=new dTree('dtree');
				dtree.add(0,
							  -1,
							  'Root',
							  'javascript:',
							  '_self');
				for(var i=0,len=nodes.length;i<len;i++){
					var node=nodes[i];
					dtree.add(node.t_id,
							  node.tp_id,
							  node.symptomName,
							   'javascript:getValue('+node.t_id+','+node.symptomName+','+node.sy_url+')',
							  '_self');
				}
				dtree.config.useSelection=true;
				dtree.config.folderLinks=false;	
				dtree.config.useCookies=false;
				document.getElementById('dtree').innerHTML=dtree;
				dtree.openAll();
				changeLinkHref();
			}else{
				Ext.Msg.alert('Error','获取字典树信息出错。');
			}
		}
	});
//}
function getValue(value){
window.returnValue=value;
window.close();
}
function changeLinkHref(){
	var _as=document.getElementsByTagName('a');
	for(var i=0,len=_as.length;i<len;i++){
		var a=_as[i];
		var _href=a.href;
		var _onclick=a.onclick;
		if(_onclick!=null){
			Ext.get(a).on('click',function(){
				getValue(this.dom.href2.replace('javascript:getValue(','').replace(')',''));
			});
			a.href2=a.href;
			a.href='#';
		}else{
			Ext.get(a).on('click',function(){
				//var _id=a.href.replace('javascript:dtree.o(').replace(');');
				dtree.o(this.dom.href2.replace('javascript:dtree.o(','').replace(');',''));
			});
			a.href2=a.href;
			a.href='#';
		}
	}
}
</script>
</head>
<body>
<div id="dtree"></div>
</body>
</html>